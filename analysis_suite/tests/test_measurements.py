"""
Tests for measurements functions
"""
import unittest
import numpy as np
import analysis_suite.measurements as meas

class TestExtractBiolumValues(unittest.TestCase):
    """
    Test function for extracting biolumninescence values
    """

    def setUp(self):
        self.labelled_wells = np.array([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                        [0, 1, 1, 0, 2, 2, 0, 3, 3, 0, 4, 4, 0, 5, 5, 0],
                                        [0, 1, 1, 0, 2, 2, 0, 3, 3, 0, 4, 4, 0, 5, 5, 0],
                                        [0, 0, 0, 0, 2, 2, 0, 3, 3, 0, 4, 4, 0, 5, 5, 0],
                                        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                        [0, 6, 6, 0, 7, 7, 0, 8, 8, 0, 9, 9, 0, 10, 10, 0],
                                        [0, 6, 6, 0, 7, 7, 0, 8, 8, 0, 9, 9, 0, 10, 10, 0],
                                        [0, 6, 6, 0, 7, 7, 0, 0, 0, 0, 9, 9, 0, 10, 10, 0],
                                        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]
                                        )

        self.fluo_image = np.array([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                        [0, 100, 200, 0, 200, 200, 0, 300, 100, 0, 400, 450, 0, 500, 520, 0],
                                        [0, 200, 100, 0, 210, 210, 0, 300, 200, 0, 450, 400, 0, 540, 560, 0],
                                        [0, 0, 0, 0, 220, 220, 0, 300, 300, 0, 500, 500, 0, 580, 600, 0],
                                        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                        [0, 600, 500, 0, 100, 100, 0, 400, 800, 0, 100, 100, 0, 101, 102, 0],
                                        [0, 100, 200, 0, 94, 100, 0, 800, 800, 0, 100, 100, 0, 104, 103, 0],
                                        [0, 400, 300, 0, 100, 100, 0, 0, 0, 0, 100, 160, 0, 105, 103, 0],
                                        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]
                                        )

        self.output_dict = {1 : [4, 150, 600],
                            2 : [6, 210, 1260],
                            3 : [6, 250, 1500],
                            4 : [6, 450, 2700],
                            5 : [6, 550, 3300],
                            6 : [6, 350, 2100],
                            7 : [6, 99, 594],
                            8 : [4, 700, 2800],
                            9 : [6, 110, 660],
                            10 : [6, 103, 618]}

    def test_extract_biolum_values(self):
        out_dict = meas.extract_biolum_values(self.labelled_wells, self.fluo_image)
        self.assertEqual(out_dict, self.output_dict)
